/**
 * Plugin for adding image to the rich text editor with FileStack
 * These ENV variables should be set
 *  - FILESTACK_API_KEY - The filestack api key
 *  - FILESTACK_SUPPORTED_IMAGE_EXTENSIONS - The supported image file type ex. image/png,image/jpg
 */

tinymce.PluginManager.add('image', function (editor, url) {
  editor.addButton('image', {
    icon: 'image',
    tooltip: 'Insert image',
    onclick: function () {
      Alchemy.FileStack.client
      .pick(Alchemy.FileStack.options)
      .then(function (response) {
        response.filesUploaded.forEach(function(image) {
          editor.insertContent('<div style="text-align: center;"><img src="'+image.url+'"></div><p></p>');
        });
      });
    }
  });
});
